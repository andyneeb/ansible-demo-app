node ('master') {
   stage('Release') {
      //gitRelease = sh(script: 'lastversion andyneeb/ansible-demo-app', , returnStdout: true).trim()
      sh 'tower-cli config host tower.andyneeb.com'
      sh 'tower-cli config verify_ssl false'
      sh 'tower-cli config username jenkins'
      sh 'tower-cli config password jenkins'
      sh 'tower-cli job_template create --name "Release Demo App v$(lastversion andyneeb/ansible-demo-app)" --project "Demo App Repo" --playbook "plays/simple.yml" --inventory "OpenStack" --extra-vars=app_release=$(lastversion andyneeb/ansible-demo-app) --extra-vars=app_stage=release --ask-limit-on-launch TRUE --credential "RHEL Cloud User Secure"'
      //withEnv(["RELEASE=$gitRelease"]) {
      //    sh 'echo ${RELEASE}'
      //    sh 'tower-cli job launch -J 16 --limit=dev --extra-vars=app_release=${MVN_VERSION} --extra-vars=app_stage=snapshot --monitor'
      //}  
     }
}
