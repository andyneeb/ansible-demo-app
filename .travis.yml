language: java
jdk:
  - openjdk8

notifications:
  slack: ci-cd-demo:H565NR29AZLfsgsztMJG1xK3

install:

  - sudo pip install ansible-tower-cli

script:
  - cp .travis/settings.xml $HOME/.m2/settings.xml 
  - mvn cobertura:cobertura
  - bash <(curl -s https://codecov.io/bash)

cache:
  directories:
  - $HOME/.m2

deploy:
 - provider: script
   script: .travis/stage.sh
   skip_cleanup: true
   on:
    all_branches: true
    condition: $TRAVIS_BRANCH != master
 - provider: script
   script: .travis/release.sh
   skip_cleanup: true
   on:
    branch: master
